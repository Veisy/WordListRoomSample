import org.gradle.nativeplatform.platform.internal.DefaultNativePlatform

def hookDest = new File("${rootProject.rootDir}/.git/hooks/pre-commit")
def preCommitHook = new File("${rootProject.rootDir}/pre-commit")

task installGitHooksTask(type: Copy) {
    hookDest.delete()
    hookDest << preCommitHook.text
	fileMode 0775
}

task gitExecutableHooks() {
	if ( DefaultNativePlatform.getCurrentOperatingSystem().isLinux() 
			|| DefaultNativePlatform.getCurrentOperatingSystem().isMacOsX() ) {
		Runtime.getRuntime().exec("chmod -R +x ${hookDest}");
		println "gitExecutableHooks"
	}
	
	if ( DefaultNativePlatform.getCurrentOperatingSystem().isWindows()) {
		println "Running on Windows.."
	}
}

gitExecutableHooks.dependsOn installGitHooksTask